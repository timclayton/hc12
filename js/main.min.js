window.onload = function() {

	function getsupportedprop(e){var t=document.documentElement;for(var n=0;n<e.length;n++){if(typeof t.style[e[n]]=="string"){return e[n]}}}var s=window.pageYOffset,d=document.body.clientHeight,wh=window.innerHeight,sPercent=1,gPercent=s/(d-wh),pos=Math.floor(sPercent),stuck,csstransform=getsupportedprop(["transform","MozTransform","WebkitTransform","msTransform","OTransform"]);window.onresize=function(){wh=window.innerHeight};window.onscroll=function(){s=window.pageYOffset;gPercent=s/(d-wh),pos=Math.floor(sPercent),next=Math.floor((s+wh)/scenes[pos-1].end+pos);var e=pos-1;if(next===pos&&stuck==false){stickScene(pos)}if(next>pos){unstickScene()}scenes.forEach(setPos,this);transforms[0].forEach(transform,this);transforms[pos].forEach(transform,this);classShifts[0].forEach(shiftClass,this);classShifts[pos].forEach(shiftClass,this)};var stickScene=function(){document.getElementById("scene"+pos).className="active";if(pos!==1){document.getElementById("scene"+(pos-1)).className="prev"}stuck=true};var unstickScene=function(){document.getElementById("scene"+next).className="";stuck=false};var duplicate=function(e){if(e.repeat>1){var t=e.order;for(var n=1;n<e.repeat;n++){var r=e.order.concat(t);e.order=r}}e.total=e.order.length};var calcPercent=function(e,t,n){if(e<t){var r=0}else if(e>=n){var r=1}else{var r=(e-t)/(n-t)}return r};var setPos=function(e){var t=calcPercent(s,e.start,e.end);if(t!==0&&t!==1){sPercent=e.scene+t}};var transform=function(e,t,n){if(n===transforms[0]){var r=calcPercent(gPercent,e.start,e.end)}else{var r=calcPercent(sPercent,e.start,e.end)}var i=e.x*r,s=e.y*r;if(e.type==="translate"){e.id.style[csstransform]="translate("+i+"px,"+s+"px)"}else if(e.type==="size"){e.id.style.width=i+"%";e.id.style.height=s+"%"}else if(e.type==="opacity"){e.id.style.opacity=i}else if(e.type==="bgShiftX"){e.id.style.backgroundPosition=i+"% 100%"}};var shiftClass=function(e,t,n){if(n===classShifts[0]){var r=calcPercent(gPercent,e.start,e.end)}else{var r=calcPercent(sPercent,e.start,e.end)}var i=e.order[Math.floor(e.total*r)];if(i!==undefined){e.id.className=e.prefix+i}};var scrollTo=function(e,t,n){if(n<0)return;var r=t-e.scrollTop;var i=r/n*10;setTimeout(function(){e.scrollTop=e.scrollTop+i;scrollTo(e,t,n-10)},10)}

	var scenes = [
	
		{scene:1, start:0, end:3000},
		{scene:2, start:3000, end:9000},
		{scene:3, start:9000, end:17000},
		{scene:4, start:17000, end:23000}
	
	]
	
	var transforms = [	// First array holds global transforms, following are per scene
	
		[  // global
		
			{id:document.getElementById("candycane1"), start: 0.07, end: 0.15, x: 60, y: -400, type:"translate"},
		
		],
		
		[  // scene 1
			
			{id:document.getElementById("strike-through"), start: 1.1, end: 1.2, x: 100, y: 50, type:"size"},
			{id:document.getElementById("text-john-berndts"), start: 1.25, end: 1.4, x: 1, y: 0, type:"opacity"},
			{id:document.getElementById("text-how-the"), start: 1.6, end: 1.99, x: 0, y: -40, type:"translate"},
			{id:document.getElementById("text-grinch"), start: 1.6, end: 1.99, x: 0, y: -60, type:"translate"},
			{id:document.getElementById("text-stole"), start: 1.6, end: 1.99, x: 0, y: -80, type:"translate"},
			{id:document.getElementById("text-christmas"), start: 1.6, end: 1.99, x: 0, y: -100, type:"translate"},
			{id:document.getElementById("grinch-face"), start: 1.85, end: 1.99, x: 0, y: -300, type:"translate"}
						
		],
		
		[  // scene 2

			{id:document.getElementById("textbox1"), start: 2.05, end: 2.15, x: 1, y: 0, type:"opacity"},
			{id:document.getElementById("textbox2"), start: 2.3, end: 2.4, x: 1, y: 0, type:"opacity"}
		
		],
		
		[  // scene 3
		
			{id:document.getElementById("ericw"), start: 3, end: 3.05, x: 1, y: 0, type:"opacity"},
			{id:document.getElementById("ericw"), start: 3.4, end: 3.6, x: -800, y: 0, type:"translate"},
			{id:document.getElementById("s3bg"), start: 3.4, end: 3.6, x: 100, y: 0, type:"bgShiftX"}
		
		]
		
	
	]
	
	var classShifts = [  // First array holds global class shifts, following are per scene
	
		[  // global
		
		],
		
		[  // scene 1
		
		],
	
		[  // scene 2
		
		],
		
		[  // scene 3
		
			{id:document.getElementById("ericw"), start: 3.1, end: 3.7, prefix: "ericw", order: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17], repeat:2}
		
		]
	
	]
	
	for ( i = 0; i < classShifts.length; i++ ) {
		classShifts[i].forEach(duplicate, this);
	}
	
	window.scrollTo(0,0);
	
	document.getElementById("play").onclick = function () {
	   scrollTo(document.body, 10000, 10000);   
	}
	
	stickScene();  //  Apply fixed positioning to first scene

}